10 REM transf. coord lambert ---> g‚ographique  lambgeo
20 rem COLOR 1,3
30 KEY OFF
40 GOSUB 1370
50 LOCATE 4,6:PRINT  "TRANSFORMATION DES COORDONNEES LAMBERT EN COORDONNEES GEOGRAPHIQUES"
60 LOCATE 6,30:PRINT "ET INVERSEMENT"
70 LOCATE 11,12:PRINT " COORDONNEES LAMBERT ----> COORDONNEES GEOGRAPHIQUES    1"
80 LOCATE 13,12:PRINT " COORDONNEES GEOGRAPHIQUES ----> COORDONNEES LAMBERT    2"
90 LOCATE 15,52:INPUT"VOTRE CHOIX   ";ICHOIX
100  DEFDBL C,R,L,X,Y,E,T,A,B,S,M,K
110  EN=2.718281828#
120  C1=3.141592654#/200
130  C2=200/3.141592654#
140  C3=3.141592654#/180
150  C4=180/3.141592654#
160 IF ICHOIX=1 THEN 170 ELSE 880
170 GOSUB 1370
180  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES LAMBERT EN COORDONNEES GEOGRAPHIQUES"
190 PRINT :PRINT:PRINT :PRINT
200 PRINT "                     LAMBERT I ...................... 1"
210 PRINT
220 PRINT "                     LAMBERT II ..................... 2"
230 PRINT
240 PRINT "                     LAMBERT III .................... 3"
250 PRINT
260 PRINT "                     LAMBERT IV ..................... 4"
270 PRINT
280 PRINT "                     EUROLAMBERT .................... 5"
290 PRINT
300 INPUT"                                         Votre choix";CHOIX
310 ON CHOIX GOTO 320,370,420,470,520
320 GOSUB 1370
330  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES LAMBERT I EN COORDONNEES GEOGRAPHIQUES"
340 GOSUB 1540
350 E=.0824832568#:M0=0:L0=55:L0=L0C1:K0=.99987734#:CX=600:CY=200:N0=6390.832014#:R0=5457.616674#:LC0=.9919966654#:A=6378.2492#:B=6356.515
360 GOTO 570
370 GOSUB 1370
380  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES LAMBERT II EN COORDONNEES GEOGRAPHIQUES"
390 GOSUB 1540
400 E=.0824832568#:M0=0:L0=52:L0=L0C1:K0=.99987742#:CX=600:CY=200:N0=6389.810331#:R0=5999.695768#:LC0=.9215573613#:A=6378.2492#
410 GOTO 570
420 GOSUB 1370
430  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES LAMBERT III EN COORDONNEES GEOGRAPHIQUES"
440 GOSUB 1540
450 E=.0824832568#:M0=0:L0=49:L0=L0C1:K0=.9998775#:CX=600:CY=200:N0=6388.7830061#:R0=6591.905065#:LC0=.8545910977#:A=6378.2492#
460 GOTO 570
470 GOSUB 1370
480 LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES LAMBERT IV EN COORDONNEES GEOGRAPHIQUES"
490 GOSUB 1540
500 E=.0824832568#:M0=0:L0=46.85:L0=L0C1:K0=.99994471#:CX=.234358:CY=185.861369#:N0=6388.048495#:R0=7053.300173#:LC0=.8084757728#:A=6378.2492#
510 GOTO 570
520 GOSUB 1370
530  LOCATE 5,4:PRINT "TRANSFORMATION DES COORDONNEES EUROLAMBERT EN COORDONNEES GEOGRAPHIQUES"
540 GOSUB 1540
550 E=.08219189#:M0=2.596921296#:M0=M0C1:L0=52:L0=L0C1:K0=.99987742#:CX=600:CY=200:N0=6389.811677#:R0=5999.697032#:LC0=.9216164165#:A=6378.388#
560 GOTO 570
570 TANALFA=(X-CX)/(R0-Y+CY)
580 ALFA=ATN(TANALFA)
590 SINL0=SIN(L0)
600 M=M0+ALFA/SINL0
610 IF CHOI$="D" OR CHOI$="d" THEN 620 ELSE 640
620 PRINT :PRINT: PRINT USING"            LONGITUDE   M =###.########ø";MC2
630 GOTO 650
640 PRINT :PRINT: PRINT USING"            LONGITUDE   M =###.######## gr";MC2
650 R=(R0-Y+CY)/COS(ALFA)
660 LC=LC0+(1/SINL0)LOG(R0/R)
670 LCS=LC
680 LS=LCS/2
690 T=((EN^LS)-(EN^(-LS)))/((EN^LS)+(EN^(-LS)))
700 SINL=(2T)/(1+T^2)
710 LCS=LC+(E/2)LOG((1+(ESINL))/(1-(ESINL)))
720 IF LCS0-LCS=0 THEN 750
730 LCS0=LCS
740 GOTO 680
750 L=2ATN(T)
760 IF CHOI$="D" OR CHOI$="d" THEN 770 ELSE 790
770 PRINT :PRINT USING"            LATITUDE    L =###.########ø";LC2
780 GOTO 800
790 PRINT :PRINT USING"            LATITUDE    L =###.######## gr";LC2
800 IF CHOI$="D" OR CHOI$="d" THEN 810 ELSE 830
810 PRINT :PRINT USING"            CONVERGENCE C =###.########ø";ALFAC2
820 GOTO 840
830 PRINT :PRINT USING"            CONVERGENCE C =###.######## gr";ALFAC2
840 NO=A*(1-(EESINLSINL))^(-.5)
850 KOEF=(RSINL0)/(NOCOS(L))
860 PRINT :PRINT USING"            COEFF.D'ECHELLE K =#.###### ";KOEF
870 close:system
880 REM transfomation coord. g‚ographiques en coord. Lambert
890 GOSUB 1370
900 LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES LAMBERT"
910 PRINT :PRINT:PRINT :PRINT
920 PRINT "                     LAMBERT I ...................... 1"
930 PRINT
940 PRINT "                     LAMBERT II ..................... 2"
950 PRINT
960 PRINT "                     LAMBERT III .................... 3"
970 PRINT
980 PRINT "                     LAMBERT IV ..................... 4"
990 PRINT
1000 PRINT "                     EUROLAMBERT .................... 5"
1010 PRINT
1020 INPUT"                                         Votre choix";CHOIX
1030 ON CHOIX GOTO 1040,1090,1140,1190,1231
1040 GOSUB 1370
1050  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES LAMBERT I"
1060 E=.0824832568#:M0=0:L0=55:L0=L0C1:K0=.99987734#:CX=600:CY=200:N0=6390.832014#:R0=5457.616674#:LC0=.9919966654#:A=6378.2492#:B=6356.515
1070 GOSUB 1600
1080 GOTO 1240
1090 GOSUB 1370
1100  LOCATE 5,6:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES LAMBERT II"
1110 E=.0824832568#:M0=0:L0=52:L0=L0C1:K0=.99987742#:CX=600:CY=200:N0=6390.810331#:R0=5999.695768#:LC0=.9215573613#:A=6378.2492#:B=6356.515
1120 GOSUB 1600
1130 GOTO 1240
1140 GOSUB 1370
1150  LOCATE 5,5:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES LAMBERT III"
1160 E=.0824832568#:M0=0:L0=49:L0=L0C1:K0=.9998775#:CX=600:CY=200:N0=6388.783061#:R0=6591.905085#:LC0=.8545910977#:A=6378.2492#:B=6356.515
1170 GOSUB 1600
1180 GOTO 1240
1190 GOSUB 1370
1200  LOCATE 5,5:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES LAMBERT IV"
1210 E=.0824832568#:M0=0:L0=46.85:L0=L0C1:K0=.99994471#:CX=.234358:CY=185.861369#:N0=6388.048495#:R0=7053.300173#:LC0=.8084757728#:A=6378.2492#:B=6356.515
1220 GOSUB 1600
1230 GOTO 1240
1231 GOSUB 1370
1232  LOCATE 5,5:PRINT "TRANSFORMATION DES COORDONNEES GEOGRAPHIQUES EN COORDONNEES EUROLAMBERT"
1233 E=.08199189#:M0=2.596921296#:M0=M0C1:L0=52:L0=L0C1:K0=.99987742#:CX=600:CY=200:N0=6389.811677#:R0=5999.697032#:LC0=.9216164165#:A=6378.388#:B=6356.911946#
1234 GOSUB 1600
1235 GOTO 1240
1240 T=TAN(L/2):SINL=(2T)/(1+TT)
1250 ALFA=(M-M0)SIN(L0)
1260 LCS=(LOG((1+T)/(1-T)))-((E/2)LOG((1+ESINL)/(1-ESINL)))
1270 R=R0EXP(((LC0-LCS)SIN(L0)))
1280 X=RSIN(ALFA)+CX
1290 Y=R0-RCOS(ALFA)+CY
1300 LOCATE 14,20:PRINT "X=";X1000
1310 LOCATE 16,20:PRINT "Y=";Y1000
1320 LOCATE 18,20:PRINT "CONVERGENCE C=";ALFAC2
1330 NO=A*(1-(EESIN(L)SIN(L)))^(-.5)
1340 KOEF=(RSIN(L0))/(NOCOS(L))
1350 LOCATE 20,20:PRINT "COEFFICIENT D'ECHELLE K= ";KOEF
1360 close:system
1370 CLS:LOCATE 3,3:PRINT CHR$(201)
1380 FOR ILI=4 TO 75
1390 LOCATE 3,ILI:PRINT CHR$(205)
1400 NEXT ILI
1410 FOR ILI=4 TO 75
1420 LOCATE 7,ILI:PRINT CHR$(205)
1430 NEXT ILI
1440 FOR ICO=4 TO 6
1450 LOCATE ICO,3:PRINT CHR$(186)
1460 NEXT ICO
1470 LOCATE 7,3:PRINT CHR$(200)
1480 FOR ICO=4 TO 6
1490 LOCATE ICO,76:PRINT CHR$(186)
1500 NEXT ICO
1510 LOCATE 3,76:PRINT CHR$(187)
1520 LOCATE 7,76:PRINT CHR$(188)
1530 RETURN
1540 LOCATE 8,6:INPUT " R‚sultat en degrŠs ou grade  D=degr‚s   G=grade ";CHOI$
1550 IF CHOI$="d" OR CHOI$="D" THEN C2=C4
1560 PRINT :PRINT
1570 INPUT"                X= ";X:X=X/1000:PRINT
1580 INPUT"                Y= ";Y:Y=Y/1000
1590 RETURN
1600 LOCATE 10,20:INPUT"LONGITUDE    M= ";M:M=MC1:PRINT
1610 LOCATE 12,20:INPUT"LATITUDE     L= ";L:L=L*C1
1620 RETURN